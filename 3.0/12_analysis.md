# Разбор задачи: Значение арифметического выражения

## Условие задачи

Задано числовое выражение. Необходимо вычислить его значение или установить, что оно содержит ошибку.

### Допустимые элементы выражения:

- Знаки сложения (+), вычитания (-), умножения (\*), скобки и пробелы
- Пробелы внутри чисел быть не должны
- Приоритет операций стандартный
- Все числа в выражении целые и по модулю не превосходят 2 × 10⁹
- Гарантируется, что все промежуточные вычисления также не превосходят 2 × 10⁹

### Формат ввода

В первой строке вводится выражение. Его длина не превосходит 100 знаков. После выражения идет переход на новую строчку.

### Формат вывода

Выведите значение этого выражения или слово "WRONG", если значение не определено.

### Ограничения

- Ограничение времени: 1с
- Ограничение памяти: 256 МБ

## Разбор решения

### Подход к решению

Задача решается с помощью алгоритма **Shunting Yard** (алгоритм сортировочной станции) для преобразования инфиксной записи в постфиксную (обратную польскую запись), а затем вычисления результата.

### Основные этапы:

#### 1. Валидация входных данных

```javascript
// Проверяем, что используются только допустимые символы
const isOnlyAllowedSymbols = (str) => {
  const allowedSymbolsRegex = /^[\d\s+\-/*()]*$/;
  return allowedSymbolsRegex.test(str);
};

// Проверяем, что между цифрами одного числа нет пробелов
const hasSpacesBetweenNumbers = (str) => {
  const spacesBetweenNumbersRegex = /\d\s+\d/;
  return spacesBetweenNumbersRegex.test(str);
};
```

#### 2. Преобразование в постфиксную запись (класс PostfixConverter)

Алгоритм использует два стека:

- **operatorStack** - для операторов и скобок
- **outputQueue** - для результата (числа и операторы в постфиксном порядке)

**Правила преобразования:**

- **Число** → добавляем в выходную очередь
- **Открывающая скобка** → помещаем в стек операторов
- **Закрывающая скобка** → выталкиваем операторы до открывающей скобки
- **Оператор** → выталкиваем операторы с большим или равным приоритетом, затем помещаем текущий

**Приоритеты операций:**

- Высокий: `*`, `/`
- Низкий: `+`, `-`

#### 3. Обработка унарного минуса

```javascript
isUnaryMinus() {
  const prevChar = this.expression[this.currentPosition - 1];
  return prevChar === OPERATORS.OPEN_PAREN || this.currentPosition === 0;
}
```

#### 4. Вычисление постфиксного выражения (класс PostfixEvaluator)

Используем стек для вычисления:

- **Число** → помещаем в стек
- **Оператор** → извлекаем два операнда, выполняем операцию, результат помещаем в стек

### Примеры работы:

#### Пример 1: `2 + 3 * 4`

1. **Инфиксная запись:** `2 + 3 * 4`
2. **Постфиксная запись:** `[2, 3, 4, *, +]`
3. **Вычисление:**
   - `2` → стек: `[2]`
   - `3` → стек: `[2, 3]`
   - `4` → стек: `[2, 3, 4]`
   - `*` → `3 * 4 = 12` → стек: `[2, 12]`
   - `+` → `2 + 12 = 14` → стек: `[14]`
4. **Результат:** `14`

#### Пример 2: `(2 + 3) * 4`

1. **Инфиксная запись:** `(2 + 3) * 4`
2. **Постфиксная запись:** `[2, 3, +, 4, *]`
3. **Вычисление:**
   - `2` → стек: `[2]`
   - `3` → стек: `[2, 3]`
   - `+` → `2 + 3 = 5` → стек: `[5]`
   - `4` → стек: `[5, 4]`
   - `*` → `5 * 4 = 20` → стек: `[20]`
4. **Результат:** `20`

#### Пример 3: `-5 + 3`

1. **Инфиксная запись:** `-5 + 3`
2. **Постфиксная запись:** `[-5, 3, +]`
3. **Вычисление:**
   - `-5` → стек: `[-5]`
   - `3` → стек: `[-5, 3]`
   - `+` → `-5 + 3 = -2` → стек: `[-2]`
4. **Результат:** `-2`

### Обработка ошибок

Функция возвращает `"WRONG"` в следующих случаях:

- Недопустимые символы в выражении
- Пробелы между цифрами одного числа
- Неправильный баланс скобок
- Неправильное расположение операторов
- Пустое выражение
- Любые другие синтаксические ошибки

### Сложность алгоритма

- **Временная сложность:** O(n), где n - длина выражения
- **Пространственная сложность:** O(n) для хранения стеков
